---
title: "Git Flow"
description: "Git Flow"
date: "2025-12-01"
tags: ["backend"]
category: "general"
slug: "git-flow"
published: true
---

## 为什么要学习 Git Flow?

**为什么所有靠谱的团队都在用 GitFlow？**

在学校里，你的代码也许只是为了通过一门课的期末作业，写错了大不了重交；但在职场上，代码是承载公司业务和用户资产的最重要的资产。

这就是为什么无论是追求稳字当头的互联网大厂，还是信奉小步快跑的创业团队，都把 GitFlow（或其变种）奉为圭臬。

由于业务极其复杂，数百人同时在一个代码仓库里协作，如果没有 develop 和 master 的严格隔离，没有 release 分支的缓冲测试，一次随意的提交就可能导致千万级的线上资损。GitFlow 提供的不仅是流程，更是权责分明与版本可追溯的安全感。

快不代表乱。越是迭代快，越需要将“正在开发的新功能”与“随时可上线的稳定版”隔离开来。GitFlow 让团队可以大胆地并行开发十个 Feature，哪个好了上哪个，而不必担心因为一个未完成的功能拖死整个版本的发布。

如果在面试时，你发现一家公司的开发流程里没有分支管理，还在通过 FTP 上传代码，或者所有人都在 `master` 主干上随意修改、没有 Code Review、没有规范的 Merge 流程。

**哪怕薪资再高，也请考虑提桶跑路。**

因为在这种“野路子”环境里，你学不到任何工程化的协作经验，每天将把 80% 的时间浪费在解决“代码被覆盖”、“线上莫名报错”和“背锅”上。选择一家重视 GitFlow 的公司，本质上是在选择一个尊重技术、尊重工程规律的职业起点。

## GitFlow 详解

Git 是一个分布式版本控制系统。每位开发者都在本地拥有项目的完整副本，这使得追踪变更、团队协作、安全测试以及自信地交付代码变得容易。

**每个人都应该知道的基本 Git 命令：**

- `git init`：初始化一个新的本地 Git 仓库。
- `git clone`：将远程 Git 仓库复制到本地机器。
- `git commit`：将你的更改保存到本地项目历史中。
- `git merge`：将另一个分支合并到当前分支。
- `git status`：显示文件的当前状态（哪些已更改、哪些准备提交等）。
- `git branch`：列出、创建或删除分支。
- `git push`：将本地提交发送到远程仓库。
- `git pull`：从远程获取最新更改并合并到本地分支。

GitFlow 是一种针对 Git 项目的分支管理策略。它由 Vincent Driessen 推广，帮助团队实现：

- **无冲突协作**
- **分离开发、新功能、发布和修复**
- **井井有条地管理预发布和生产环境的交付**

让我们来看一个典型的 GitFlow 工作流：

### GitFlow 中的主要分支

🔵 main (或 master)

生产分支。这里的每一次提交都代表一个已部署的版本。版本会被打上标签（Tag，如 v1.0, v1.1...）。

🟣 develop

集成分支。所有新功能在进入发布阶段之前都会合并到这里。

🟢 feature

从 develop 创建的功能分支。当功能开发完成后，会合并回 develop。

🟦 release

当一个版本准备定型时，从 develop 创建此分支。这是在上线生产环境前进行测试和最终修复的地方。

🟠 hotfix

从 main 创建，用于快速修复生产环境中的严重 Bug。修复完成后会同时合并到 main 和 develop。

### 从 RC 到生产环境 (Production)

当创建一个 `release` 分支时，项目就进入了 **候选发布 (Release Candidate, RC)** 阶段。这是一个接近最终完成的版本，会被部署到预发布环境（Staging）进行验证。

RC1 - 第一个候选发布版

通过 GitLab 流水线自动创建一个 1.x.x-RC1 标签。构建 Docker 镜像并发布到 Nexus。该版本发送给 QA 团队进行测试。与之并行的是，下一个版本（例如 RC2-SNAPSHOT）也开始准备。

RCx (后续候选版)

如果发现任何问题，直接在 release 分支上应用修复，并生成新的候选发布版（RC2, RC3 等）。这个循环可以重复进行，直到 QA 团队完全批准该发布。

进入生产环境 (GA - General Availability)

一旦最终的 RC 版本通过审批且没有严重 Bug，它就成为了 GA（正式可用）版本。此时 release 分支会被合并：

1. **合并到 main/master** → 部署到生产环境。
2. **合并到 develop** → 确保修复内容保留在开发分支中。

🔄 **小贴士：** 在关闭 `release` 分支之前，请务必更新你的本地 `main` 和 `develop` 分支，以避免合并冲突。

Hotfixes (紧急修复) ：生产环境出现严重 Bug？不需要等待下一次发布。

操作如下：

1. 从 `main/master` 创建一个分支 `hotfix/v1.0.1`。
2. 应用修复代码。
3. 立即部署。
4. 然后将 hotfix 合并到：
   - `main/master` → 确保生产环境包含该修复。
   - `develop` → 确保开发分支也保留该修复。

GitFlow 不仅仅是一种分支策略——它是一种思维方式，帮助团队自信地交付高质量软件。通过清晰地分离开发、发布和生产修复，它减少了混乱，并提高了协作效率，特别是在多环境工作流中。

无论你是独自工作还是在团队中，采用 GitFlow 都能为你的版本控制流程带来结构和清晰度。从简单的开始，根据你的工作流进行调整，让它随着你的项目共同成长。

## **入职第一周 GitFlow 避雷生存指南**

很多时候，老员工不是故意不教你，而是这些操作对他们来说已经是肌肉记忆，他们默认你懂。但如果你不懂，踩了坑，在 Code Review 时被公开处刑，或者弄脏了公共分支，印象分会大打折扣。

---

### 0. 检查配置

在写下第一行代码前，先检查这三个配置。如果错了，你的提交在 Git 历史上会显得非常业余，甚至会被运维找上门。

- **雷点 1：用私人邮箱提交代码**
  - **后果：** 公司内部统计代码贡献量时找不到你；你的私人 QQ 邮箱暴露在公司仓库里。
  - **避雷操作：**
  ```bash
  # 必须设置成公司分配的邮箱
  git config --global user.email "san.zhang@company.com"
  git config --global user.name "ZhangSan"
  ```
- **雷点 2：换行符冲突 (LF vs CRLF)**
  - **后果：** 你只是改了一个字，结果 Diff 显示整个文件都被修改了（因为 Windows 和 Mac/Linux 的换行符不同）。
  - **避雷操作：**
  ```bash
  # Mac/Linux 用户
  git config --global core.autocrlf input
  # Windows 用户
  git config --global core.autocrlf true
  ```

### 1. 起手时：要有切分支强迫症

不切分支这是新人最容易犯的错误，没有之一。

- **雷点：在 `develop` 或 `master` 上直接写代码**
  - **场景：** 你拉下代码，觉得只是改个标点符号，直接改了。等到要提交时才发现不能 push，这时候再想切分支就很麻烦。
  - **后果：** 污染公共分支，被 Leader 骂。
  - **避雷口诀：** **不见 Feature 不动工。**
  - **操作：** 每天早上打开 IDE，第一件事看右下角（或终端输入 `git branch`）。如果不是 `feature/xxx`，手离开键盘，立刻切分支。

### 2. 提交时：拒绝垃圾日志

Code Review 时，导师第一眼看的不是代码，是 Commit Message。

- **雷点：提交日志写 "update", "fix bug", "111"**
  - **后果：** 两个月后出问题回溯时，没人知道这坨代码是干嘛的。这是极不专业的表现。
  - **避雷操作：** 遵守 **Conventional Commits** 规范。
    - `feat: 新增用户登录接口` (新功能)
    - `fix: 修复空指针异常` (修 Bug)
    - `docs: 更新接口文档` (文档)
    - `style: 格式化代码` (不改逻辑)
    - `refactor: 重构订单服务` (重构)
- **雷点：把一堆不相关的文件混在一个 Commit 里**
  - **后果：** 你在一个 Commit 里既改了登录逻辑，又顺手改了订单页面的错别字。如果登录逻辑要回滚，错别字修复也跟着没了。
  - **避雷操作：** **原子性提交**。一件事一个 Commit，不要怕 Commit 多。

### 3. 同步时：防冲突的猥琐流

新人往往埋头苦写三天，一抬头发现变天了（同事提交了大量代码）。

- **雷点：写完代码直接 Push，不拉最新代码**
  - **后果：** 产生冲突，甚至不小心覆盖了别人的代码。
  - **避雷操作：** **推前必拉**。
  - 在你准备 `git push` 之前，务必执行：
  ```bash
  # 1. 确保在你的 feature 分支
  # 2. 把远程 develop 的新代码合过来
  git pull origin develop
  # 3. 有冲突本地解决，解决完没问题了
  # 4. 再推送到你的远程 feature
  git push origin feature/xxx
  ```

### 4. 提测前：清理不相关文件

不要把你的私人物品带到公共仓库。

- **雷点：提交了 `.idea`, `.vscode`, `target/`, `.class`, `DS_Store` 文件**
  - **后果：** 你的 IDE 配置文件会覆盖同事的配置，导致全组人的项目跑不起来。这是**一级事故**。
  - **避雷操作：**
    - 检查项目根目录有没有 `.gitignore` 文件。
    - 在 `git add .` 之前，先用 `git status` 看一眼，一旦发现绿色的文件里混进了奇奇怪怪的东西，立刻停下来去配置 `.gitignore`。

### 5. 绝招：如果不小心搞砸了

如果你不小心在 `develop` 上 commit 了，或者误删了代码，**千万不要**做以下两件事：

1. **不要** 试图用 `git push -f` (强制推送) 来掩盖错误。这是死罪。
2. **不要** 默默地不说话试图自己修。

- **正确姿势：**
  - 立刻停手。
  - 截图报错信息。
  - 找到导师，诚恳地说：“导师，我刚才 Git 操作可能有点问题，能不能帮我看一下？”（Git 都是有反悔药的，只要没强推，导师 30 秒就能救回来，比如用 `git reflog`）。

---

**总结给应届生的一句话：Git 的本质是保存现场和同步进度。**

在入职第一周，**慢就是快**。哪怕你敲每一个 Git 命令前都先问一下 ChatGPT “这个命令是干嘛的”，也比你凭直觉敲回车然后搞崩仓库要好得多。稳住，祝你顺利度过第一周。

## 演进

[GitHub flow - GitHub Docs](https://docs.github.com/en/get-started/using-github/github-flow)
